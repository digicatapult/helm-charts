{{ if hasKey .Values.keycloak "auth" }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: keycloak-realms
  namespace: default
data:
  sequence-minimal-realm.json: |
    {
      "realm": "sequence-minimal-realm",
      "enabled": true,
      "clients": [
        {
          "name": "sequence-minimal-client",
          "clientId": "sequence",
          "publicClient": true,
          "clientAuthenticatorType": "client-secret",
          "secret": "secret",
          "directAccessGrantsEnabled": true,
          "redirectUris": [
            "/*"
          ],
          "webOrigins": [
            "+"
          ],
          "attributes": {
            "post.logout.redirect.uris": "/*"
          }
        }
      ],
      "users": [
        {
          "username": "service-account-sequence",
          "enabled": true,
          "credentials": [
            {
              "type": "password",
              "value": "secret"
            }
          ],
          "realmRoles": [
            "user"
          ],
          "clientRoles": {
            "account": [
              "manage-account",
              "view-profile"
            ],
            "sequence": [
              "user"
            ]
          }
        }
      ]
    }
{{ end }}
